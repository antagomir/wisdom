 %% wisdom-songbook
 %% ===============
 %%
 %% Collection of songs etc
 %%
 
\documentclass[twoside,10pt]{book}
\usepackage[finnish,english]{babel}\selectlanguage{english}

\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[scaled=1.05]{noto}

\usepackage[bookmarks,unicode]{hyperref} % used by 'songs' package for index links in PDF
  \hypersetup{linkbordercolor=0.2 0.6 0.9,
              pdftitle=Wisdom Songbook,
              unicode=true}
% TODO: consider if the tmargin should be smaller. It can be as small as 16mm,
%       as it was in earlier versions
\usepackage[a5paper,inner=20mm,outer=10mm,tmargin=20mm,bmargin=10mm,headsep=6.5mm,headheight=3.5mm,nofoot]{geometry} % page size + margins
\usepackage{graphicx}
\usepackage{pdfpages} % for cover page
% \usepackage[font=footnotesize]{caption}
\usepackage{color}
% Disable all warnings issued by latex starting with "You have requested package..." to allow
% warningless loading of packages from subdirectories without setting environment variables
% (can be omitted, but warnings will appear):
\usepackage{silence}\WarningFilter{latex}{You have requested package}

\usepackage{xstring}

% The most important 'songs' package, use the version in the project tree:
\usepackage[chorded]{ext_packages/songs}

\graphicspath{ {./content/img/} } % graphicx: set path to find images from

\definecolor{chordcolor}{rgb}{0.3,0,0.4} % color: use this for chords
\definecolor{mbarcolor}{rgb}{0.8,0.7,0.9} % color: use this for measure bars (lighter color)
\definecolor{verylightgray}{rgb}{0.94,0.94,0.94} % color: use this for song number bg & textnote bg (lighter gray)

\renewcommand{\snumbgcolor}{verylightgray} % songs: song number (in prelude) background color
\renewcommand{\notebgcolor}{verylightgray} % songs: \musicnote and \textnote background color
\renewcommand{\idxbgcolor}{verylightgray} % songs: index alphabet sectino background color

\songcolumns{1} % songs: number of columns per page in songs environment  
\songpos{3} % songs: song same column-page-doublepage positioning aggressiveness 0-3
\noversenumbers % songs: do not display verse numbers
\renewcommand{\lyricfont}{\sffamily\large} % songs: modify lyrics font style
% songs: modify chord font style (add color and make smaller):
\renewcommand\printchord[1]{\sffamily\bfseries\small\color{chordcolor}#1}
% songs: modify meter class font style (add color):
\renewcommand{\meterfont}{\color{chordcolor}\scriptsize\sffamily\upshape}
\renewcommand{\notefont}{\normalsize} % songs: modify \textnote and \musicnote font (make smaller)
% songs: use same text color for music notes as for chords:
\renewcommand\musicnote[1]{\ifchorded\textnote{\color{chordcolor}#1}\fi}%
\renewcommand{\clineparams}{ % distance of chords to lyrics (needed because of font scaling)
  \baselineskip=10.6pt
  \lineskiplimit=-2pt
  \lineskip=-2pt
}
% songs: make capo note smaller
\renewcommand\capo[1]{%
  \iftranscapos\transpose{#1}\else\musicnote{{\scriptsize capo #1}}\fi%
}
% songs: reduces line spacing in non-chorded lyrics by the amount the chords would take space
%        without needing to set \chordsoff; also removes measure bar lines. Commented out for
%        now:
% \setlength\baselineadj{-\baselineskip}

% \renewcommand{\chaptername}{Part} % would set chapter name to 'Part', does not work with babel
%\addto\captionsfinnish{\renewcommand\chaptername{Part}} % sets chapter name to Part when babel: finnish
\addto\captionsenglish{\renewcommand\chaptername{Part}} % sets chapter name to Part when babel: english
% \renewcommand{\thechapter}{\Alph{chapter}} %% use alphabets instead of numbers for chapters

% Comment the following line out if you don't want AH numbers shown in song preludes.
% Define it for a song by adding ah= parameter to \beginsong
\newcommand{\showahnumber}{}

% Comment the following line out if you don't want extra info shown in song preludes.
% Define it for a song by adding ex= parameter to \beginsong
% It can be used to for example indicate the origins or a language of a song.
\newcommand{\showextrainfo}{} % comment this line out if you don't want extra info shown (ex=?)

% Comment the following line out if you don't want tag lists shown in song preludes
% Define a list of tags for a song by adding tags= parameter to \beginsong
% It is supposed to be a short list of single word tags of which an index is created.
\newcommand{\showtaglist}{} % comment this line out if you don't want tag list shown (tags=?)

% This command will display some text followed by three dots, 
% and aligned to the right of the page. The idea is to use it as a signal to go to
% a different part of the song, for example the chorus. You can use it within the
% last verse or between verses (in such a case it will be put on its own line).
\newcommand{\gotochorus}[1]{\hfill {\normalsize\textit{→ #1\ldots}}}

% This command will make a small horizontal space. Use this for example in the
% beginning of chorus lines, if you wish the chorus to stand out visually.
\newcommand{\chorusindent}{\hspace{1em}}

% Displays the parameter text centered in a large font. Use within songs, but outside
% verses. Intended to be used for short mantras for recitation.
\newcommand{\showmantra}[1]{{\vspace{1.5em}\begin{center}\Large #1\end{center}}\vspace{1.0em}}

% more project settings: longer renewcommands for songs package etc:
\input{wisdom-songbook-extra.tex}

% environment for 'song feeler'
\newenvironment{feeler}{
  \vspace{2em}
  \small
  \par\noindent\ignorespaces
  \begin{center}\begin{em}
}{
  \end{em}\end{center}
  %\par\noindent\ignorespacesafterend
}

% environment for 'song explanation'
\newenvironment{explanation}{
  \vspace{2em}
  \footnotesize
  \par\noindent\ignorespaces
}{
  \par\noindent\ignorespacesafterend
}

% environment for song translation, to be used inside a song
\newenvironment{translation}{
  \newcommand{\nextverse}{\medskip} % some vertical space between verses
  \beginverse*
  \chordsoff
  %\obeylines  
  \vspace{1em}
  \small\textit
  %\par\noindent\ignorespaces
}{
  \endverse
  %\par\noindent\ignorespacesafterend
}

% songs: create indexes
\newindex{titleidx}{idx_wisdom-sb_title}
\newauthorindex{authidx}{idx_wisdom-sb_auth}
\newscripindex{tagidx}{idx_wisdom-sb_tag}

        
\begin{document}

  \begin{titlepage}
    \includepdf[]{content/img/COVER_temporary.pdf}
    \thispagestyle{empty}
    \topskip0pt
    \vspace*{\fill}    
    \begin{center}
      \Huge Songs of Wisdom\\
      \normalsize \textit{Paths to higher knowledge}\\
      \Large
      \vspace{3em}
      By:\\
      \textbf{humankind},\\
      inspired by the universe \\
      \vspace{1em}
      Version: \the\year-\the\month-\the\day \textit{ alpha}
      \\
      \vspace*{\fill}
      \let\thefootnote\relax{\scriptsize Compiled by: antagomir \& larva}
    \end{center}    
  \end{titlepage}
  
  \tableofcontents % TODO: make two-column TOC using perhaps multitoc package

  \clearpage\scleardpage
  \songchapter{Saṃskṛtam}
    \section{Hindu Bhajans \& Mantras} 
      \begin{songs}{titleidx,authidx,tagidx}
        \setcounter{songnum}{100}
        \input{content/songs_mantra_hindu.tex}
      \end{songs}
     \scleardpage
    \section{Tibetan Buddhist Mantras}
      \begin{songs}{titleidx,authidx,tagidx}
        \setcounter{songnum}{170}
        \input{content/songs_mantra_buddhist.tex}
      \end{songs}  
  
  \clearpage\scleardpage
  \songchapter{Español}
    \begin{songs}{titleidx,authidx,tagidx}
      \setcounter{songnum}{200}
      \input{content/songs_spanish.tex}
    \end{songs}
    
  \clearpage\scleardpage    
  \songchapter{Português}
    \begin{songs}{titleidx,authidx,tagidx}
      \setcounter{songnum}{300}
      \input{content/songs_portuguese.tex}
    \end{songs}
  
  \clearpage\scleardpage
  \songchapter{English}  
    \begin{songs}{titleidx,authidx,tagidx}
      \setcounter{songnum}{400}
      \input{content/songs_english.tex}
    \end{songs}

  \clearpage\scleardpage
  \songchapter{Other}  
    \begin{songs}{titleidx,authidx,tagidx}
      \setcounter{songnum}{700}
      \input{content/songs_other.tex}
    \end{songs} 
    
  \clearpage\scleardpage
  \songchapter{Suomi}
    \begin{otherlanguage}{finnish} % set language to finnish for hyphenation etc
      \section{Lauluja}
        \begin{songs}{titleidx,authidx,tagidx}
          \setcounter{songnum}{800}
          \input{content/songs_suomi.tex}
          % larva's scribblings (remove later?):
          \input{content/songs_larva.tex}
        \end{songs}
      \clearpage\scleardpage
      \section{Muinaissuomalaista mytologiaa}
        \input{content/suomi_mytologiaa.tex}
      \clearpage\scleardpage
      \section{Runoja, loitsuja}
        \begin{songs}{titleidx,authidx,tagidx}
          \setcounter{songnum}{900}
          \chordsoff % do not show empty line for non-existing chords
          \renewcommand{\lyricfont}{\sffamily\small} % songs: modify lyrics font style
          \songcolumns{2}% two columns per page!
          % Make penalty for breaking column/page at any line of lyrics to be only slightly
          % higher than penalty for breaking between verses. The default for \interlinepenalty
          % is 1000, all other penalties are 200 by default.
          \interlinepenalty=201%
          \input{content/songs_suomi_runoja_loitsuja.tex}
          \interlinepenalty=1000 % back to default
          \songcolumns{1} % back to one column per page
          \renewcommand{\lyricfont}{\sffamily\large} % songs: modify lyrics font style
          \chordson
        \end{songs}
    \end{otherlanguage}

  \clearpage\scleardpage
  \songchapter{Technical information}
    \section{Chords for Guitar}
      \gtab{Dm/F}{XX3231:003241} \gtab{D\textdegree7}{XX0101:000102} \\
      \gtab{F#\textdegree7}{XX1212:001324} \gtab{Am6/E}{XX2212:002314} \\
      \gtab{G(5)}{XX5403:003201} \gtab{G6}{XX5430:003210} \gtab{G7sus4}{330011:340011} \gtab{Gadd9}{XX5435:003214} \\
      \gtab{B\textdegree7}{X20101:030102} \\
      \vfill
    \section{Circles}
      %\vspace{4em}
      \begin{center}
         \hfill
         \includegraphics[width=0.382\textwidth]{mandala-illusion_transparent_bg_1280px.png}
         \hfill
         \includegraphics[width=0.382\textwidth]{Circle_fifths_transparent_bg_2000px.png}
         \hfill
      \end{center}

  
  \clearpage
  \showindex[2]{Song Index}{titleidx} % song title index  
  % \showindex{Author Index}{authidx} % song author index
  \showindex[2]{Tag Index}{tagidx} % tags index

\end{document}
